<% include ../partials/header %>
<div class="container">
<div class="row">
    <h1 style="text-align: center;">Edit Room <%=room['roomName']%></h1>
    <div style="width: 50%; margin:25px auto;">
        <form action="/room/<%=room['_id']%>/?_method=PUT" method="POST" class="update-form">
        	<div class="form-group row">
                <label class="col-sm-6 col-form-label" for="roomName">Room Name</label>
            	<input class="col-sm-20" type="text" id="id" name="roomName" value="<%=room['roomName']%>"required>
            </div>
            <div class="form-group row">
                <label class="col-sm-6 col-form-label" for="roomType">Room Type</label>
                <select class="col-sm-20" name="roomType">
                    <option value="-1" selected="selected" disabled>Select Your Room Type</option>
                    <%  let roomTypes = ["Vegetative and Flowering", "Vegetative", "Flowering"]
                        roomTypes.forEach(function(roomType){ 
                    %>
                    <option value="<%=roomType%>" <% if (room['roomType'] === roomType) { %>selected="selected"<% } %>><%=roomType%></option>
                    <%  }) %>
                </select>
            </div>
             <% 
                for(const deviceNameKey in deviceObj){
                    /* Remove spaces from device name so that the bootstrap collapse class will work correctly  */
                    let deviceNameStr = deviceNameKey.replace(/\s/g,'');
                %>
                    <div class="form-group row">
                        <label class="col-sm-6 col-form-label" for="roomDeviceIds"><%=deviceNameKey%></label>
                        <select class="col-sm-20" name="roomDeviceIds" multiple="true">
                            <option value="-1" selected="selected" disabled>Select Your <%=deviceNameKey%></option>
                            <% 
                                deviceObj[deviceNameKey].forEach(function(device){ 
                            	   if(room['roomDeviceIds'].includes(device['_id'])){
                            %>
                            	<option value="<%=device['_id']%>" selected='true'><%=device['deviceName']%></option>
                            <%      } else { %>
                            	<option value="<%=device['_id']%>"><%=device['deviceName']%></option>
                            <%
                                	}
                                });
                            %>
                        </select>
                    </div>
                <%        
                }
            %>  
            <div class="form-group row">
                <button class="btn btn-lg btn-primary btn-block">Submit!</button>
            </div>
        </form>
        <a href="/room">Go Back</a>
    </div>
<% include ../partials/footer %>


