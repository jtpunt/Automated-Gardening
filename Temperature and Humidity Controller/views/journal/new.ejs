<script type="text/javascript">
    function roomSelectFn(event){
        console.log(event.value);
        let roomType = event.value;
        let roomTypeContent = document.getElementById(roomType + "Content");
        console.log(roomTypeContent);
        roomTypeContent.hidden = false;
    }
</script>
<div class="collapse" id="collapseNew">
    <div class="well" style="border-left: 5px solid #00C851;">
        <!--If the user is logged in, show the new schedule form-->
        <h4>Add your journal details <span class="glyphicon glyphicon glyphicon-pencil" aria-hidden="true"></span></h4>
        <form id="add-comment-form" action="/journal" method="POST">
            <div class="form-group row">
                <label class="col-sm-6 col-form-label" for="journalName">Journal Name</label>
            	<input class="col-sm-20" type="text" id="journalName" name="journalName" required>
            </div>
            <div class="form-group row">
                <label class="col-sm-6 col-form-label" for="roomId">Set Room</label>
                <select onchange="roomSelectFn(this)" class="col-sm-20" name="roomId">
                    <option value="-1" selected disabled>Select Your Room:</option>
                    <% 
                        let waterPumpSettingsFound = false;
                        rooms.forEach(function(room){ 
                            if(room['roomWaterDetails'].length){
                                waterPumpSettingsFound = true;
                            }
                    %>
                            <option value="<%=room['roomType']%>"><%=room['roomName']%></option>
                    <% 
                        });
                    %>
                </select>
            </div>
            <% 
                let roomTypes = ["Vegetative and Flowering", "Vegetative", "Flowering"] 
                roomTypes.forEach(function(roomType){
                    if(roomType === "Vegetative and Flowering"){
            %>
                <fieldset class="form-group" id="<%=roomType%>Content" hidden>
                    <div  class="row">
                        <legend class="col-sm-6 col-form-label"><%=roomType%> Additional Settings</legend>
                        <div>
                            <label class="col-sm-6 col-form-label" for="<%=roomType%>GrowLength">Total Grow Length (weeks)</label>
                            <input class="col-sm-20" type="number" min="16" max="52" name="<%=roomType%>GrowLength" required> 
                        </div>
                    </div>
                    <div class="row">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th scope="col">Week #</th>
                                    <th scope="col">Total Cups Dispersed Per Line</th>
                                    <th scope="col">Relay Run Time</th>
                                </tr>
                            </thead>
                            <tbody id="weeklyTbody">
                                <tr>
                                    <th>1</th>
                                    <td><input type="number" min="16" max="52" required></td>
                                    <td><input type="number" min="16" max="52" step=".5" required></td>
                                </tr>
                                <tr>
                                    <th>2</th>
                                    <td><input type="number" min="16" max="52" required></td>
                                    <td><input type="number" min="16" max="52" step=".5" required></td>
                                </tr>
                                <tr>
                                    <th>3</th>
                                    <td><input type="number" min="16" max="52" required></td>
                                    <td><input type="number" min="16" max="52" step=".5" required></td>
                                </tr>
                            </tbody>
                        </table>
                        
                </fieldset>
            <%
                    } else { 
            %>
                <div id="<%=roomType%>Content" class="form-group row" hidden>
                    <label class="col-sm-6 col-form-label" for="<%=roomType%>"><%=roomType%></label>
                    <input class="col-sm-20" type="text" name="<%=roomType%>" required>
                </div>
            <%
                    }
                })
            %>
            <fieldset class="form-group">
                <div class="row">
                    <legend class="col-sm-6 col-form-label">Select Time Mode</legend>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="timeMode" value="day">
                        <label class="form-check-label" for="dayMode">Day Mode</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="timeMode" value="night">
                        <label class="form-check-label" for="dayMode">Night Mode</label>
                    </div>
                </div>
            </fieldset>
            <div class="form-group row">
                <label class="col-sm-6 col-form-label" for="vegStartDate">Set Start Date: </label>
                <input class="col-sm-20" type="date" id="vegStartDate" name="vegetative[start_date]"required>
            </div>
            <div class="form-group row">
                <button class="btn btn-success btn-sm">Add Room <i class="fa fa-calendar" aria-hidden="true"></i></button>
            </div>
        </form>
    </div>
</div>